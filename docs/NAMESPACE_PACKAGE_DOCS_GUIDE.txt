# Namespace Package Documentation System

This documentation system provides a flexible way to create mini-documentation sites for each ACCV-Lab namespace package using **manual configuration only**.

## How It Works

Each namespace package contains its own documentation in a `docs/` directory within the package:

```
packages/
├── examples/
│   ├── docs/
│   │   ├── index.rst      # Main entry point (auto-generated)
│   │   ├── intro.rst      # Basic intro template (auto-generated once)
│   │   ├── api.rst        # API reference (auto-generated)
│   │   ├── examples.rst   # Manual examples page (user-created)
│   │   └── ...            # Any additional manual pages
│   ├── examples/          # Package source code
│   ├── setup.py
│   └── ...
└── other_package/
    ├── docs/
    │   ├── index.rst
    │   ├── intro.rst
    │   ├── api.rst
    │   └── ...
    ├── other_package/     # Package source code
    ├── setup.py
    └── ...
```

## Configuration (Required)

The system uses a **shared configuration file** that is used by both the build system and documentation:

**File: `namespace_packages_config.py` (in project root)**
```python
# Namespace packages to build and document - MUST be manually configured
NAMESPACE_PACKAGES = [
    'accvlab.examples',
    'accvlab.algorithms',      # Example: add more as needed
    'accvlab.utilities',
    # Add new namespace packages here
]
```

**Important**: 
- There is no automatic discovery. You must manually add each namespace package to this list.
- This single file is used by both `setup.py` (for installation) and `docs/conf.py` (for documentation)
- Keeps build and documentation systems synchronized

## What Gets Auto-Generated

When you run `python3 generate_new_namespace_package_docs.py`, the system creates:

1. **`index.rst`** - Main entry point with navigation (always regenerated)
2. **`intro.rst`** - Basic introduction template (created only if it doesn't exist)
3. **`api.rst`** - Complete API reference using Sphinx autodoc (always regenerated)
4. **Main `docs/index.rst`** - Updated with current namespace packages in the navigation (always regenerated)

The main documentation index is automatically updated to include all namespace packages from the NAMESPACE_PACKAGES list, so you never need to manually edit the main navigation.

## Adding Manual Pages

You can add as many additional pages as needed:

1. Create a new `.rst` file in the namespace package's docs folder:
   ```rst
   # packages/examples/docs/tutorials.rst
   Tutorials
   =========
   
   Your content here...
   ```

2. Add it to the toctree in the package's `index.rst`:
   ```rst
   .. toctree::
      :maxdepth: 2

      intro
      api
      examples
      tutorials  # <-- Add your new page
   ```

## Building Documentation

The build process automatically regenerates namespace package docs:

```bash
make html
# or
python3 generate_new_namespace_package_docs.py  # Generate only
sphinx-build -b html . _build/html     # Build only
```

## Error Handling

If `NAMESPACE_PACKAGES` is not configured properly, you'll get helpful error messages:

- Missing `namespace_packages_config.py`: "Could not import NAMESPACE_PACKAGES from namespace_packages_config.py"
- Missing `NAMESPACE_PACKAGES`: "NAMESPACE_PACKAGES not found in namespace_packages_config.py"
- Empty list: "NAMESPACE_PACKAGES list is empty in namespace_packages_config.py"

## Adding New Namespace Packages

To add a new namespace package:

1. **Update the shared configuration** in `namespace_packages_config.py`:
   ```python
   NAMESPACE_PACKAGES = [
       'accvlab.examples',
       'accvlab.algorithms',  # <-- Add here
   ]
   ```

2. **Both build and docs will use the same list automatically**:
   ```bash
   # Building the package
   pip install -e .  # Uses namespace_packages_config.py
   
   # Generating documentation  
   cd docs && python3 generate_new_namespace_package_docs.py  # Uses namespace_packages_config.py
   ```

3. **Everything is automatically updated**:
   - Main documentation index includes the new namespace package
   - Individual namespace package documentation folder is created
   - Build system includes it in compilation
   - No manual editing of navigation files needed

4. **Customize the documentation**:
   - Edit `packages/algorithms/docs/intro.rst`
   - Add manual pages as needed
   - Update navigation in the namespace package's `index.rst`

## Shared Configuration Benefits

- ✅ **Single Source of Truth**: One file controls both build and documentation
- ✅ **No Duplication**: NAMESPACE_PACKAGES list defined only once
- ✅ **Automatic Sync**: Build and docs always stay in sync
- ✅ **Easy Maintenance**: Add new packages in one place

## Example Structure

For the `accvlab.examples` namespace package:

- **Configuration**: Listed in `namespace_packages_config.py`
- **Build**: Included in `setup.py` build process
- **Navigation**: Appears as "Examples Package" in docs
- **URL**: `/namespace_packages/examples/index.html`
- **Files**: All contained in `packages/examples/docs/`

## Best Practices

1. **Keep `intro.rst` customized** - Edit the template to match your package
2. **Don't edit `index.rst` or `api.rst`** - These are regenerated automatically
3. **Always update `namespace_packages_config.py`** - Single place for all configuration
4. **Add manual pages for**:
   - Examples and tutorials
   - Installation guides (if package-specific)
   - Performance notes
   - Integration guides
5. **Use descriptive filenames** - `examples.rst`, `tutorials.rst`, `performance.rst`

## Benefits

- **Explicit Control**: Complete manual control over which packages are documented
- **No Discovery**: Predictable behavior, no surprises from filesystem changes
- **Synchronized Systems**: Build and documentation always use the same package list
- **Modular**: Each namespace package has complete, self-contained documentation
- **Flexible**: Mix auto-generated API docs with manual content
- **Scalable**: Adding new namespace packages is just updating one file
- **Clean**: No intermediate navigation levels, direct mapping
- **Maintainable**: Templates and API docs regenerate automatically
- **Error-Safe**: Clear error messages when configuration is missing
- **Self-Contained**: Each package's documentation lives with its source code

This system provides complete control through manual configuration while automating only the API documentation generation, and keeps build and documentation systems perfectly synchronized. 